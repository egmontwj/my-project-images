<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Kernel Density Map Viewer</title>
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.114/Build/Cesium/Cesium.js"></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.114/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
  <style>
    html, body, #cesiumContainer {
      width: 100%; height: 100%; margin: 0; padding: 0; overflow: hidden;
      font-family: sans-serif;
    }
    #menu {
      position: absolute;
      top: 5px;
      left: 5px;
      background: rgba(42, 42, 42, 0.8);
      padding: 10px;
      border-radius: 4px;
      z-index: 1;
    }
    #menu button {
      display: block;
      margin-bottom: 5px;
      width: 180px;
    }
  </style>
</head>
<body>
  <div id="cesiumContainer"></div>
  <div id="menu">
    <button onclick="setLayer('chicago')">Chicago POI</button>
    <button onclick="setLayer('shenzhen')">Shenzhen POI</button>
    <button onclick="setLayer('none')">Remove Layers</button>
  </div>
  <script>
    // Initialize Cesium viewer with terrain disabled
    const viewer = new Cesium.Viewer('cesiumContainer', {
      imageryProvider: new Cesium.OpenStreetMapImageryProvider({
        url : 'https://a.tile.openstreetmap.org/'
      }),
      terrainProvider: new Cesium.EllipsoidTerrainProvider(), // Disables 3D elevation
      animation: false,
      timeline: false,
      geocoder: false,
      homeButton: false,
      sceneModePicker: false,
      baseLayerPicker: false,
      navigationHelpButton: false,
    });

    // Fly to initial position
    viewer.camera.flyTo({
      destination: Cesium.Cartesian3.fromDegrees(114.3, 30.6, 3500000),
      orientation: {
        heading: Cesium.Math.toRadians(0.0),
        pitch: Cesium.Math.toRadians(-90.0),
        roll: 0.0,
      }
    });

    let currentLayer = null;

    function setLayer(city) {
      if (currentLayer) {
        viewer.imageryLayers.remove(currentLayer);
        currentLayer = null;
      }

      if (city === 'chicago') {
        currentLayer = viewer.imageryLayers.addImageryProvider(
          new Cesium.UrlTemplateImageryProvider({
            url: 'https://storage.googleapis.com/myearth-465423-bucket/imp_chicago_cart_tiles/{z}/{x}/{y}.png',
            maximumLevel: 13,
            tilingScheme: new Cesium.WebMercatorTilingScheme()
          })
        );
      } else if (city === 'shenzhen') {
        currentLayer = viewer.imageryLayers.addImageryProvider(
          new Cesium.UrlTemplateImageryProvider({
            url: 'https://storage.googleapis.com/myearth-465423-bucket/imp_shenzhen_cart_tiles/{z}/{x}/{y}.png',
            maximumLevel: 13,
            tilingScheme: new Cesium.WebMercatorTilingScheme()
          })
        );
      }
    }
  </script>
</body>
</html>
